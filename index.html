<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.js"></script>
    <script src="data_generator.js"></script>
  </head>
  <body>

    <script>

      $(document).ready(function(){
        var $body = $('body');
        $body.html('');
        var $refresh = $('<button type="button" id="refresh" >Refresh new Tweets!</button>');
        $refresh.appendTo($body);
        $('<br></br><br></br>').appendTo($body);

        var index = streams.home.length - 1;


        $refresh.on('click', function() {
          $refresh.remove();
          while(index >= 0){
            var tweet = streams.home[index];
            var $tweet = $('<div id="tweets"></div>');
            var $userButton = $('<button type="button" id="user" data-name="'+tweet.user+'">@'+ tweet.user +'</button>');
            $tweet.prepend(': ' + tweet.message);
            $tweet.prepend($userButton);
            $tweet.appendTo($body);
            $('<p style="font-size: 10px">Time: </p>').append(Date($.now())).appendTo($tweet);
            index -= 1;

            $('div #user').on('click', function() {
              var username = tweet.user;
              var allTweets = streams.users[username];
              $('div').remove();
              var $allTweets = $('<div></div>');

              $allTweets.prepend($('<br></br>'));
              $allTweets.prepend('@' + username + ' tweets: ');
              for (var i = 0; i < allTweets.length; i++) {
                var thisTweet = allTweets[i].message;
                var thisTime = $('<p style="font-size: 10px">Time: </p>').append(allTweets[i].created_at);
                $allTweets.append(thisTweet);
                $allTweets.append(thisTime);

              }
              $allTweets.appendTo($body);
            });
          }
        });


        // $('div #user').on('click', function() {
        //   var username = $(this).data('name');
        //   var allTweets = stream.users[username];
        //   $(this).closest('body').remove();
        //   var $tweet = $('<div></div>');
        //   for (var i = 0; i < allTweets.length; i++) {
        //     $tweet.append(allTweets[i]);
        //     $tweet.appendTo($body);
        //   }
        // });

      });

    </script>
  </body>
</html>
